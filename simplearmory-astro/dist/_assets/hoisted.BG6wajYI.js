import{g as f,a as y,p as F,b as k}from"./Nav.astro_astro_type_script_index_0_lang.CT0JDFuw.js";const w=new Map;async function C(t,e,o){if(!t||!e||!o)throw new Error("Region, realm, and character are required");const r=`${t}_${e}_${o}`;if(w.has(r))return w.get(r);try{const c=`/api/battlePets?region=${encodeURIComponent(t)}&realm=${encodeURIComponent(e)}&character=${encodeURIComponent(o)}`,a=await fetch(c);if(!a.ok)throw new Error(`Failed to fetch battle pets: ${a.status} ${a.statusText}`);const s=await a.json();return w.set(r,s),s}catch(c){throw console.error("Error fetching battle pets:",c),c}}let m=!1;document.addEventListener("DOMContentLoaded",async()=>{try{window.ga&&window.ga("send","pageview","BattlePets");const t=document.getElementById("showlevels");t&&t.addEventListener("change",function(){m=this.checked;const r=document.querySelectorAll(".pbLevel"),c=document.querySelectorAll(".pbBreed");r.forEach(a=>{m?a.classList.add("opacityOn"):a.classList.remove("opacityOn")}),c.forEach(a=>{m?a.classList.add("opacityOn"):a.classList.remove("opacityOn")})});const e=f();if(!e||!e.region||!e.realm||!e.character){u("Missing character information");return}document.title=y(e.character,"Battle Pets");const o=await C(e.region,e.realm,e.character);if(!o){u("Failed to load battle pets data");return}E(o),$(o)}catch(t){console.error("Error loading battle pets:",t),u(t.message||"Failed to load battle pets")}});function E(t){const e=document.getElementById("progress-container");if(e){const o=`
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: ${F(t.collected,t.possible)}%;" aria-valuenow="${t.collected}" aria-valuemin="0" aria-valuemax="${t.possible}"></div>
        </div>
        <div class="progress-text">${k(t.collected,t.possible)}</div>
      `;e.innerHTML=o}}function $(t){const e=document.getElementById("battle-pets-container");if(e){e.innerHTML="";for(const o of t.categories){const r=document.createElement("div");r.className="category";const c=document.createElement("h3");c.textContent=o.name,r.appendChild(c);for(const a of o.subcats){const s=document.createElement("div");s.className="subcategory";const v=document.createElement("h4");v.textContent=a.name,s.appendChild(v);const g=document.createElement("div");g.className="items";for(const n of a.pets){const d=document.createElement("div");d.className="pet-item";const h=document.createElement("div");h.className="pbCell";const l=document.createElement("a");l.className=`thumbnail pbThumbnail${n.collected?"":" notCollected"}`,l.href=n.ptr||n.new?`//www.wowhead.com/ptr-2/battle-pet/${n.id}`:`//www.wowhead.com/battle-pet/${n.id}`,l.target="_blank";const p=document.createElement("img");if(p.height=36,p.width=36,p.src=x(n),p.alt=n.name,l.appendChild(p),n.currentLevel){const i=document.createElement("div");i.className=`pbLevel${m?" opacityOn":""}`,i.textContent=n.currentLevel,l.appendChild(i)}if(n.breed){const i=document.createElement("div");i.className=`pbBreed${m?" opacityOn":""}`,i.textContent=n.breed,l.appendChild(i)}h.appendChild(l);const b=document.createElement("div");b.className="pbQual",b.style=B(n),h.appendChild(b),d.appendChild(h);const L=`
            <div class="tooltip-content">
              <div class="tooltip-title">${n.name}</div>
              <div class="tooltip-description">${n.description||""}</div>
              ${n.source?`<div class="tooltip-source">Source: ${n.source.text}</div>`:""}
              ${n.currentLevel?`<div class="tooltip-level">Level: ${n.currentLevel}/${n.maxLevel||25}</div>`:""}
              ${n.qualityId?`<div class="tooltip-quality">Quality: ${I(n.qualityId)}</div>`:""}
            </div>
          `;d.setAttribute("data-tooltip",L),d.addEventListener("mouseenter",function(){const i=this.getAttribute("data-tooltip");q(this,i)}),d.addEventListener("mouseleave",function(){T()}),g.appendChild(d)}s.appendChild(g),r.appendChild(s)}e.appendChild(r)}}}function B(t){let e="transparent";if(t.qualityId!==void 0)switch(t.qualityId){case 0:e="#7F7F7F";break;case 1:e="#F0F0F0";break;case 2:e="#22B14C";break;case 3:e="#3F48CC";break;case 4:e="#9932CC";break;case 5:e="#FFA500";break}else if(t.quality)switch(t.quality){case"poor":e="#7F7F7F";break;case"common":e="#F0F0F0";break;case"uncommon":e="#22B14C";break;case"rare":e="#3F48CC";break;case"epic":e="#9932CC";break;case"legendary":e="#FFA500";break}return`background:${e}`}function I(t){switch(t){case 0:return"Poor";case 1:return"Common";case 2:return"Uncommon";case 3:return"Rare";case 4:return"Epic";case 5:return"Legendary";default:return"Unknown"}}function x(t,e=!1){return`${e?"https://wow.zamimg.com/images/wow/icons/small/":"https://wow.zamimg.com/images/wow/icons/large/"}${t.icon}.jpg`}function u(t){const e=document.getElementById("battle-pets-container");e&&(e.innerHTML=`
        <div class="error">
          <i class="glyphicon glyphicon-exclamation-sign"></i>
          <p>${t}</p>
        </div>
      `)}function q(t,e){let o=document.getElementById("pet-tooltip");o||(o=document.createElement("div"),o.id="pet-tooltip",o.className="tooltip",document.body.appendChild(o)),o.innerHTML=e;const r=t.getBoundingClientRect(),c=o.getBoundingClientRect();let a=r.top-c.height-10,s=r.left+r.width/2-c.width/2;a<0&&(a=r.bottom+10),s<0&&(s=0),s+c.width>window.innerWidth&&(s=window.innerWidth-c.width),o.style.top=`${a+window.scrollY}px`,o.style.left=`${s}px`,o.style.display="block"}function T(){const t=document.getElementById("pet-tooltip");t&&(t.style.display="none")}document.addEventListener("router:update",async()=>{const t=f();if(window.location.hash.startsWith("#/battlePets")&&t.region&&t.realm&&t.character){document.title=y(t.character,"Battle Pets");try{const e=await C(t.region,t.realm,t.character);if(!e){u("Failed to load battle pets data");return}E(e),$(e)}catch(e){console.error("Error loading battle pets:",e),u(e.message||"Failed to load battle pets")}}});
