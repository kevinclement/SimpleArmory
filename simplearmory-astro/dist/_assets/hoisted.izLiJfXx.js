import{g as h,a as m}from"./Nav.astro_astro_type_script_index_0_lang.CT0JDFuw.js";const u=new Map;async function g(e,t,n){if(!e||!t||!n)throw new Error("Region, realm, and character are required");const r=`${e}_${t}_${n}`;if(u.has(r))return u.get(r);try{const o=`/api/reputations?region=${encodeURIComponent(e)}&realm=${encodeURIComponent(t)}&character=${encodeURIComponent(n)}`,l=await fetch(o);if(!l.ok)throw new Error(`Failed to fetch reputations: ${l.status} ${l.statusText}`);const s=await l.json();return u.set(r,s),s}catch(o){throw console.error("Error fetching reputations:",o),o}}document.addEventListener("DOMContentLoaded",async()=>{try{window.ga&&window.ga("send","pageview","Reputation");const e=h();if(!e||!e.region||!e.realm||!e.character){c("Missing character information");return}document.title=m(e.character,"Reputation");const t=await g(e.region,e.realm,e.character);if(!t||!t.categories){c("Failed to load reputation data");return}v(t.categories)}catch(e){console.error("Error loading reputations:",e),c(e.message||"Failed to load reputations")}});function v(e){const t=document.getElementById("reputations-container");if(t){t.innerHTML="";for(const n of e){const r=document.createElement("h3");r.textContent=n.name,t.appendChild(r);const o=document.createElement("ul");o.className="faction-list";for(const l of n.factions){const s=document.createElement("li");s.className="faction-item";const a=C(l);s.appendChild(a),o.appendChild(s)}t.appendChild(o)}}}function C(e){const t=document.createElement("div");t.className="reputation-row";const n=document.createElement("h4");n.className="faction-label";const r=document.createElement("a");r.href=`https://www.wowhead.com/faction=${e.id}`,r.target="_blank",r.textContent=e.name,n.appendChild(r),t.appendChild(n);const o=document.createElement("div");o.className="reputation-progress";for(let a=0;a<e.levels.length;a++){const w=e.levels[a],i=document.createElement("div");i.className="rep-progress-block",i.title=`${w[1]}${$(e,a)}`,i.style.width=`${f(e,a)}px`,i.style.border=`1px solid ${y(e,a)}`;const d=document.createElement("div");d.style.backgroundColor=p(e,e.level),d.style.height="100%",d.style.width=`${E(e,a)*100}%`,i.appendChild(d),o.appendChild(i)}t.appendChild(o);const l=document.createElement("span");l.className="reputation-status";const s=document.createElement("b");if(s.style.color=p(e,e.level),s.textContent=e.levels[e.level][1],l.appendChild(s),e.max!==0&&!(e.renown&&e.level==e.levels.length-1)){const a=document.createElement("span");a.style.color="grey",a.textContent=` â€¢ ${e.value} / ${e.max}`,l.appendChild(a)}return t.appendChild(l),t}function p(e,t){const n=["#c22","red","#e62","#d29d01","#55b101","#55b101","#55b101","#0ec077"];return n[Math.max(0,e.renown?Math.floor(t/(e.levels.length-1)*(n.length-1)):n.length-(e.levels.length-t))]}function y(e,t){return t<=e.level?p(e,e.level):"lightgray"}function E(e,t){return e.renown&&e.level==e.levels.length-1?1:t===e.level?e.perc/100:t<e.level?1:0}function $(e,t){if(t==e.levels.length-1)return"";{const n=e.levels[t+1][0]-e.levels[t][0];let r;return t===e.level?r=e.value:t<e.level?r=n:r=0,": "+r+" / "+n}}function f(e,t){const n=e.levels[t][0];if(t<e.levels.length-1){const r=e.levels[t+1][0],o=e.levels[e.levels.length-1][0],l=(r-n)/o;return Math.max(l*400-1,0)}else return 10}function c(e){const t=document.getElementById("reputations-container");t&&(t.innerHTML=`
        <div class="error">
          <i class="glyphicon glyphicon-exclamation-sign"></i>
          <p>${e}</p>
        </div>
      `)}document.addEventListener("router:update",async()=>{const e=h();if(window.location.hash.startsWith("#/reputations")&&e.region&&e.realm&&e.character){document.title=m(e.character,"Reputation");try{const t=await g(e.region,e.realm,e.character);if(!t||!t.categories){c("Failed to load reputation data");return}v(t.categories)}catch(t){console.error("Error loading reputations:",t),c(t.message||"Failed to load reputations")}}});
